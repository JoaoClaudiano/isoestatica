<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Isostática Interativa</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial, sans-serif; margin:0; background:#f0f4f8; color:#333; }
header { display:flex; justify-content:space-between; align-items:center; background:#005b96; color:white; padding:10px 20px; position: sticky; top:0; z-index:100; }
header h1 { margin:0; font-size:1.5em; }
#hamburger { font-size:28px; cursor:pointer; }

/* Sidebar esquerda (menu hamburger) */
#sidebar { height:100%; width:0; position:fixed; z-index:2000; top:0; left:0; background:#007acc; overflow-x:hidden; transition:0.3s; padding-top:60px; color:white; }
#sidebar a { padding:15px 20px; display:block; text-decoration:none; color:white; transition:0.2s; font-weight:bold;}
#sidebar a:hover { background:#005b96; }
#sidebar .closebtn { position:absolute; top:10px; right:15px; font-size:30px; cursor:pointer; }

/* Sidebar direita fixa (edição de elementos) */
#rightSidebar { position:fixed; top:60px; right:0; width:300px; height:calc(100% - 60px); background:#f9f9f9; border-left:1px solid #ccc; overflow-y:auto; padding:10px; z-index:1500; }
#rightSidebar h3 { margin-top:0; color:#005b96; }
.element { border-bottom:1px solid #ccc; padding:5px; margin-bottom:5px; cursor:pointer; }
.element:hover { background:#e0f0ff; }
.editSection { margin-top:10px; padding:5px; background:#f1f8ff; border-radius:5px; }

/* Main content */
#main { margin:10px 310px 10px 10px; }
#controls { display:flex; flex-wrap:wrap; gap:5px; margin-bottom:10px; }
#controls button { flex:1 1 auto; padding:8px; background:#007acc; color:white; border:none; border-radius:5px; cursor:pointer; font-weight:bold; }
#controls button:hover { background:#005b96; }

/* Canvas */
#canvasContainer { position:relative; width:100%; margin-bottom:10px; overflow:hidden; }
canvas { width:100%; height:400px; border:1px solid #999; background-image: radial-gradient(#ccc 1px, transparent 1px); background-size:20px 20px; display:block; }
#crosshair { position:absolute; width:20px; height:20px; pointer-events:none; border:1px solid red; border-radius:50%; transform:translate(-50%, -50%); }

/* Diagramas */
.diagramSection { background:white; border-radius:8px; padding:10px; margin-bottom:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
.diagramSection h3 { margin:0 0 5px 0; color:#005b96; }

#memoryCard { background:white; border-radius:8px; padding:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1); margin-bottom:20px; }
#memoryCard h3 { color:#005b96; margin-top:0; }

/* Footer */
footer { background:#005b96; color:white; text-align:center; padding:15px; font-size:0.9em; }
footer a { color:white; text-decoration:none; margin:0 5px; }
footer a:hover { text-decoration:underline; }

/* Responsivo */
@media(max-width:900px){
    #main { margin:10px 10px 10px 10px; }
    #rightSidebar { width:100%; height:250px; top:auto; bottom:0; border-left:none; border-top:1px solid #ccc; }
}
</style>
</head>
<body>

<header>
  <h1>Isostática Interativa</h1>
  <span id="hamburger">&#9776;</span>
</header>

<!-- Sidebar esquerda hamburger -->
<div id="sidebar">
  <span class="closebtn" onclick="closeSidebar()">&times;</span>
  <a href="aba/metodologia-vigas.html" target="_blank">Metodologia Vigas</a>
  <a href="aba/metodologia-trelicas.html" target="_blank">Metodologia Treliças</a>
  <a href="aba/sobre-nos.html" target="_blank">Sobre Nós</a>
  <a href="aba/contato.html" target="_blank">Contato</a>
</div>

<!-- Sidebar direita fixa -->
<div id="rightSidebar">
  <h3>Elementos Criados</h3>
  <div id="elementList">Nenhum elemento ainda.</div>
  <div id="editSection" class="editSection"></div>
</div>

<div id="main">

  <div id="controls">
    <button onclick="addNodePrompt()">Adicionar Nó/Apoio</button>
    <button onclick="startDrawBeam()">Desenhar Viga</button>
    <button onclick="addLoadPrompt()">Adicionar Carga Concentrada</button>
    <button onclick="addDistLoadPrompt()">Adicionar Carga Distribuída</button>
    <button onclick="addMomentPrompt()">Adicionar Momento</button>
    <button onclick="addHingePrompt()">Adicionar Rótula</button>
    <button onclick="resetStructure()">Resetar Estrutura</button>
  </div>

  <div id="canvasContainer">
    <canvas id="canvas"></canvas>
    <div id="crosshair"></div>
  </div>

  <div id="memoryCard">
    <h3>Memória de cálculo das reações</h3>
    <div id="reactionMemory">Nenhuma reação calculada ainda.</div>
  </div>

</div>

<footer>
<p>© 2024 Isostática Interativa | Desenvolvido com ❤️ por [Nome da Equipe]</p>
<p>
<a href="pages/politica.html">Política de Privacidade</a> |
<a href="pages/termos.html">Termos de Uso</a> |
<a href="pages/ajuda.html">Ajuda</a> |
<a href="pages/contato.html">Contato</a>
</p>
</footer>

<script>
// Sidebar esquerda
const sidebar = document.getElementById("sidebar");
document.getElementById("hamburger").onclick = () => { sidebar.style.width="250px"; };
function closeSidebar() { sidebar.style.width="0"; }

// Modelo estrutural
const model = { nodes:[], elements:[], loads:[], distLoads:[], moments:[], hinges:[] };
let nodeIdCounter=1, tempNode=null;
const canvas = document.getElementById('canvas');
canvas.width = canvas.offsetWidth;
canvas.height = canvas.offsetHeight;
const ctx = canvas.getContext('2d');
const crosshair = document.getElementById('crosshair');

// Mira
canvas.addEventListener("mousemove", e => {
  const rect = canvas.getBoundingClientRect();
  crosshair.style.left = (e.clientX - rect.left) + "px";
  crosshair.style.top = (e.clientY - rect.top) + "px";
});

// Funções com confirmação de posição
function addNodePrompt() {
  const x = parseFloat(prompt("Informe X do nó (px ou metros):","50"));
  const y = parseFloat(prompt("Informe Y do nó (px ou metros):","50"));
  if(isNaN(x)||isNaN(y)) return;
  model.nodes.push({id:nodeIdCounter++, x, y});
  updateRightSidebar(); draw(); updateMemoryCard();
}

function startDrawBeam() {
  canvas.onclick = e => {
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    let node = {id:nodeIdCounter++, x, y};
    model.nodes.push(node);
    if(!tempNode) { tempNode = node; alert("Clique no segundo nó para finalizar a viga"); }
    else {
      const confirmX = parseFloat(prompt("Confirme X do segundo nó:", node.x));
      const confirmY = parseFloat(prompt("Confirme Y do segundo nó:", node.y));
      node.x = isNaN(confirmX)?node.x:confirmX;
      node.y = isNaN(confirmY)?node.y:confirmY;
      model.elements.push({n1: tempNode, n2: node});
      tempNode=null; canvas.onclick=null;
    }
    updateRightSidebar(); draw(); updateMemoryCard();
  };
}

function addLoadPrompt() {
  const nodeId = parseInt(prompt("Nó onde aplicar carga (ID):","1"));
  const value = parseFloat(prompt("Valor da carga (kN):","10"));
  const node = model.nodes.find(n=>n.id===nodeId);
  if(node){ model.loads.push({node,value}); updateRightSidebar(); draw(); updateMemoryCard(); }
}

function addDistLoadPrompt() {
  const elIndex = parseInt(prompt("Índice da viga para carga distribuída:","0"));
  const value = parseFloat(prompt("Valor da carga distribuída (kN/m):","5"));
  const el = model.elements[elIndex];
  if(el){ model.distLoads.push({element:el,value}); updateRightSidebar(); draw(); updateMemoryCard(); }
}

function addMomentPrompt() {
  const nodeId = parseInt(prompt("Nó onde aplicar momento (ID):","1"));
  const value = parseFloat(prompt("Valor do momento (kN·m):","5"));
  const node = model.nodes.find(n=>n.id===nodeId);
  if(node){ model.moments.push({node,value}); updateRightSidebar(); draw(); updateMemoryCard(); }
}

function addHingePrompt() {
  const elIndex = parseInt(prompt("Índice da viga para rótula:","0"));
  const el = model.elements[elIndex];
  if(el){ model.hinges.push({element:el}); updateRightSidebar(); draw(); updateMemoryCard(); }
}

function resetStructure() {
  model.nodes=[]; model.elements=[]; model.loads=[]; model.distLoads=[]; model.moments=[]; model.hinges=[]; tempNode=null;
  updateRightSidebar(); draw(); updateMemoryCard();
}

// Desenho
function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  // Vigas
  model.elements.forEach(el=>{
    ctx.strokeStyle="#007acc"; ctx.lineWidth=3;
    ctx.beginPath(); ctx.moveTo(el.n1.x, el.n1.y); ctx.lineTo(el.n2.x, el.n2.y); ctx.stroke();
  });
  // Nós
  model.nodes.forEach(n=>{
    ctx.fillStyle="#ff0000"; ctx.beginPath(); ctx.arc(n.x,n.y,5,0,2*Math.PI); ctx.fill();
  });
  // Cargas concentradas
  ctx.strokeStyle="green"; ctx.fillStyle="green";
  model.loads.forEach(l=>{
    ctx.beginPath(); ctx.moveTo(l.node.x, l.node.y-20); ctx.lineTo(l.node.x, l.node.y); ctx.stroke();
    ctx.fillText(l.value+" kN", l.node.x+5, l.node.y-25);
  });
  // Momentos
  ctx.strokeStyle="orange";
  model.moments.forEach(m=>{
    ctx.beginPath(); ctx.arc(m.node.x, m.node.y,15,0,Math.PI*1.5); ctx.stroke();
    ctx.fillText(m.value+" kN·m", m.node.x+20,m.node.y-20);
  });
}

// Sidebar direita
function updateRightSidebar() {
  const container = document.getElementById("elementList");
  const editSection = document.getElementById("editSection");
  if(model.nodes.length+model.elements.length===0){ container.innerHTML="Nenhum elemento ainda."; editSection.innerHTML=""; return; }
  let html="";
  model.nodes.forEach(n=>html+=`<div class="element" onclick="editNode(${n.id})">Nó ${n.id} - (${n.x.toFixed(0)},${n.y.toFixed(0)})</div>`);
  model.elements.forEach((el,i)=>html+=`<div class="element" onclick="editElement(${i})">Viga ${i+1} - Nó ${el.n1.id} a Nó ${el.n2.id}</div>`);
  container.innerHTML=html;
  editSection.innerHTML="";
}

function editNode(id){
  const node = model.nodes.find(n=>n.id===id);
  const editSection = document.getElementById("editSection");
  editSection.innerHTML = `
    <h4>Editar Nó ${id}</h4>
    X: <input type="number" id="editX" value="${node.x}"><br>
    Y: <input type="number" id="editY" value="${node.y}"><br>
    <button onclick="saveNode(${id})">Salvar</button>
  `;
}
function saveNode(id){
  const node = model.nodes.find(n=>n.id===id);
  node.x = parseFloat(document.getElementById("editX").value);
  node.y = parseFloat(document.getElementById("editY").value);
  updateRightSidebar(); draw(); updateMemoryCard();
}

function editElement(index){
  const el = model.elements[index];
  const editSection = document.getElementById("editSection");
  editSection.innerHTML = `
    <h4>Editar Viga ${index+1}</h4>
    Nó 1: X <input type="number" id="elX1" value="${el.n1.x}"> Y <input type="number" id="elY1" value="${el.n1.y}"><br>
    Nó 2: X <input type="number" id="elX2" value="${el.n2.x}"> Y <input type="number" id="elY2" value="${el.n2.y}"><br>
    <button onclick="saveElement(${index})">Salvar</button>
  `;
}
function saveElement(index){
  const el = model.elements[index];
  el.n1.x = parseFloat(document.getElementById("elX1").value);
  el.n1.y = parseFloat(document.getElementById("elY1").value);
  el.n2.x = parseFloat(document.getElementById("elX2").value);
  el.n2.y = parseFloat(document.getElementById("elY2").value);
  updateRightSidebar(); draw(); updateMemoryCard();
}

// Memória de cálculo simulada
function updateMemoryCard(){
  const container = document.getElementById("reactionMemory");
  if(model.nodes.length===0){ container.innerHTML="Nenhuma reação calculada ainda."; return; }
  let html="<ul>";
  model.nodes.forEach(n=>html+=`<li>Nó ${n.id}: Fx=0 kN, Fy=0 kN, Mz=0 kN·m</li>`);
  html+="</ul>";
  container.innerHTML = html;
}

// Inicial
updateRightSidebar(); draw(); updateMemoryCard();
</script>

</body>
</html>
